<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Donor Registration</title>
<style>
body{background:#020617;color:white;font-family:Arial;display:flex;justify-content:center;align-items:center;height:100vh}
.box{background:#0f172a;padding:25px;border-radius:10px;width:330px;text-align:center}
input,select,button{width:100%;padding:10px;margin:6px;border-radius:5px;border:none}
button{background:#22c55e;font-weight:bold}
</style>
</head>

<body>

<div class="box">
<h2>ðŸ©¸ Donor Registration</h2>

<input id="name" placeholder="Name">
<input id="age" placeholder="Age">
<select id="blood">
<option>O+</option><option>O-</option>
<option>A+</option><option>A-</option>
<option>B+</option><option>B-</option>
<option>AB+</option><option>AB-</option>
</select>
<input id="city" placeholder="City">
<input id="phone" placeholder="Phone">
<input id="email" placeholder="Email">
<input id="pass" type="password" placeholder="Password">

<button onclick="register()">Register & Verify Email</button>

<div id="msg"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, sendEmailVerification }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, setDoc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC9xmxYgma37ABQKKmVbOME-ndACMPB200",
  authDomain: "blood-donar-9f832.firebaseapp.com",
  projectId: "blood-donar-9f832",
  storageBucket: "blood-donar-9f832.firebasestorage.app",
  messagingSenderId: "913291193453",
  appId: "1:913291193453:web:f7f5f0f6fd1d103c03a364"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.register = async ()=>{

  let name=name.value;
  let age=age.value;
  let blood=blood.value;
  let city=city.value;
  let phone=phone.value;
  let email=email.value;
  let pass=pass.value;

  const user = await createUserWithEmailAndPassword(auth,email,pass);
  await sendEmailVerification(user.user);

  await setDoc(doc(db,"donors",user.user.uid),{
    name,age,phone,
    blood, bloodLower:blood.toLowerCase(),
    city, cityLower:city.toLowerCase(),
    email
  });

  msg.innerHTML="âœ… Registered. Check your email to verify.";
}
</script>
</body>
</html>
